"use strict";(self.webpackChunktoolbox=self.webpackChunktoolbox||[]).push([[744],{3860:function(e,t,n){n.r(t),n.d(t,{ImageEditor:function(){return g}});var r=n(4942),a=n(9439),u=n(1233),l=n(8081),o=n(4386),c=n(5884),i=n(1326),s=n(8552),f=n(8343),m=(n(3621),n(4160),n(5346),n(9487),n(8078),n(9140),n(9564),n(1846),n(7952),n(7068),n(6655),n(2835),n(1485),n(3744),n(188),n(4703),n(657),n(7812),new Set);function C(e){var t=e.title,n=e.className,r=e.imageRef,a=e.src;return function(e){if(!m.has(e))throw new Promise((function(t){var n=new Image;n.src=e,n.onload=function(){m.add(e),t(null)}}))}(a),u.createElement("img",{className:n||void 0,src:a,title:t,ref:r,draggable:"false"})}function g(e){var t=e.src,n=e.title,m=e.nodeKey,g=(0,u.useRef)(null),d=(0,u.useRef)(null),O=(0,o.useLexicalNodeSelection)(m),M=(0,a.Z)(O,3),N=M[0],_=M[1],E=M[2],R=(0,l.useLexicalComposerContext)(),A=(0,a.Z)(R,1)[0],D=(0,u.useState)(null),I=(0,a.Z)(D,2),v=I[0],S=I[1],p=(0,u.useRef)(null),L=(0,u.useCallback)((function(e){if(N&&(0,i.$isNodeSelection)((0,i.$getSelection)())){e.preventDefault();var t=(0,i.$getNodeByKey)(m);(0,s.$)(t)&&t.remove()}return!1}),[N,m]),T=(0,u.useCallback)((function(e){var t=(0,i.$getSelection)(),n=d.current;return!(!N||!(0,i.$isNodeSelection)(t)||1!==t.getNodes().length||null===n||n===document.activeElement)&&(e.preventDefault(),n.focus(),!0)}),[N]),b=(0,u.useCallback)((function(e){return d.current===e.target&&((0,i.$setSelection)(null),A.update((function(){_(!0);var e=A.getRootElement();null!==e&&e.focus()})),!0)}),[A,_]);(0,u.useEffect)((function(){var e=!0,t=(0,c.mergeRegister)(A.registerUpdateListener((function(t){var n=t.editorState;e&&S(n.read((function(){return(0,i.$getSelection)()})))})),A.registerCommand(i.SELECTION_CHANGE_COMMAND,(function(e,t){return p.current=t,!1}),i.COMMAND_PRIORITY_LOW),A.registerCommand(i.CLICK_COMMAND,(function(e){var t=e;return t.target===g.current&&(t.shiftKey?_(!N):(E(),_(!0)),!0)}),i.COMMAND_PRIORITY_LOW),A.registerCommand(i.DRAGSTART_COMMAND,(function(e){return e.target===g.current&&(e.preventDefault(),!0)}),i.COMMAND_PRIORITY_LOW),A.registerCommand(i.KEY_DELETE_COMMAND,L,i.COMMAND_PRIORITY_LOW),A.registerCommand(i.KEY_BACKSPACE_COMMAND,L,i.COMMAND_PRIORITY_LOW),A.registerCommand(i.KEY_ENTER_COMMAND,T,i.COMMAND_PRIORITY_LOW),A.registerCommand(i.KEY_ESCAPE_COMMAND,b,i.COMMAND_PRIORITY_LOW));return function(){e=!1,t()}}),[E,A,N,m,L,T,b,_]);var Y=(0,i.$isNodeSelection)(v),P=N;return u.createElement(u.Suspense,{fallback:null},u.createElement(u.Fragment,null,u.createElement("div",{draggable:Y,className:s.s.imageWrapper,"data-editor-block-type":"image"},u.createElement(C,{className:f((0,r.Z)({},s.s.focusedImage,P)),src:t,title:n||"",imageRef:g}))))}}}]);
//# sourceMappingURL=744.5ca7f6ee.chunk.js.map